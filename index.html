<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AuraLearn: Intelligent Learning Architect</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">

    <!-- Linking to external style.css for better organization -->
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-primary text-primary antialiased">
    <!-- Main Application Container -->
    <!-- Added 'h-screen' to app-container to ensure it takes full height, making 'main' scrollable within it -->
    <div id="app-container" class="flex flex-col lg:flex-row min-h-screen w-full mx-auto shadow-lg rounded-2xl">

        <!-- Mobile Header (Visible on smaller screens) -->
        <header class="mobile-header lg:hidden flex items-center justify-between p-4 bg-secondary border-b border-border-color rounded-t-2xl">
            <h1 class="text-xl font-bold text-primary">AuraLearn</h1>
            <button id="menu-button" class="p-2 rounded-md hover:bg-border-color text-primary">
                <i class="fas fa-bars text-lg"></i>
            </button>
        </header>

        <!-- Mobile Sidebar (Hidden by default, shown via menu button) -->
        <div id="mobile-sidebar-container" class="hidden">
            <aside id="mobile-sidebar" class="w-64 bg-secondary p-6 shadow-xl fixed h-full z-50 rounded-r-2xl overflow-y-auto">
                <div class="flex items-center justify-between mb-8">
                    <h2 class="text-2xl font-bold text-primary">AuraLearn</h2>
                    <button id="close-menu-button" class="p-2 rounded-md hover:bg-border-color text-primary">
                        <i class="fas fa-times text-lg"></i>
                    </button>
                </div>
                <nav class="flex-grow">
                    <a href="#" class="nav-item flex items-center gap-3" data-view="dashboard">
                        <i class="fas fa-home fa-lg"></i>
                        <span>Dashboard</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="calendar">
                        <i class="fas fa-calendar-alt fa-lg"></i>
                        <span>Calendar</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="library">
                        <i class="fas fa-book-open fa-lg"></i>
                        <span>Library</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="ai-learning">
                        <i class="fas fa-robot fa-lg"></i>
                        <span>AI Learning Studio</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="mind-map">
                        <i class="fas fa-brain fa-lg"></i>
                        <span>Mind Map</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="glossary">
                        <i class="fas fa-file-alt fa-lg"></i>
                        <span>Glossary</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="analytics">
                        <i class="fas fa-chart-line fa-lg"></i>
                        <span>Analytics</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="achievements">
                        <i class="fas fa-trophy fa-lg"></i>
                        <span>Achievements</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="focus">
                        <i class="fas fa-lightbulb fa-lg"></i>
                        <span>Focus Tools</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="learning-hub">
                        <i class="fas fa-graduation-cap fa-lg"></i>
                        <span>Learning Hub</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="settings">
                        <i class="fas fa-cog fa-lg"></i>
                        <span>Settings</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="tutorial">
                        <i class="fas fa-question-circle fa-lg"></i>
                        <span>Tutorial</span>
                    </a>
                </nav>
                <div class="mt-8 pt-4 border-t border-border-color">
                    <p class="text-sm text-secondary">Logged in as:</p>
                    <p id="sidebar-username-mobile" class="font-semibold text-primary"></p>
                </div>
            </aside>
        </div>

        <!-- Desktop Sidebar (Always visible on larger screens) -->
        <!-- Added overflow-y-auto to desktop aside for scrollability if content exceeds height -->
        <aside class="hidden lg:flex w-64 bg-secondary p-6 flex-col justify-between rounded-l-2xl overflow-y-auto">
            <div>
                <h2 class="text-2xl font-bold text-primary mb-8">AuraLearn</h2>
                <nav>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="dashboard">
                        <i class="fas fa-home fa-lg"></i>
                        <span>Dashboard</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="calendar">
                        <i class="fas fa-calendar-alt fa-lg"></i>
                        <span>Calendar</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="library">
                        <i class="fas fa-book-open fa-lg"></i>
                        <span>Library</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="ai-learning">
                        <i class="fas fa-robot fa-lg"></i>
                        <span>AI Learning Studio</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="mind-map">
                        <i class="fas fa-brain fa-lg"></i>
                        <span>Mind Map</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="glossary">
                        <i class="fas fa-file-alt fa-lg"></i>
                        <span>Glossary</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="analytics">
                        <i class="fas fa-chart-line fa-lg"></i>
                        <span>Analytics</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="achievements">
                        <i class="fas fa-trophy fa-lg"></i>
                        <span>Achievements</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="focus">
                        <i class="fas fa-lightbulb fa-lg"></i>
                        <span>Focus Tools</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="learning-hub">
                        <i class="fas fa-graduation-cap fa-lg"></i>
                        <span>Learning Hub</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="settings">
                        <i class="fas fa-cog fa-lg"></i>
                        <span>Settings</span>
                    </a>
                    <a href="#" class="nav-item flex items-center gap-3" data-view="tutorial">
                        <i class="fas fa-question-circle fa-lg"></i>
                        <span>Tutorial</span>
                    </a>
                </nav>
            </div>
            <div class="mt-8 pt-4 border-t border-border-color">
                <p class="text-sm text-secondary">Logged in as:</p>
                <p id="sidebar-username" class="font-semibold text-primary"></p>
            </div>
        </aside>

        <!-- Main Content Area -->
        <!-- Ensured main content area is scrollable. Added dynamic height adjustment for smaller screens -->
        <main class="flex-grow p-6 sm:p-8 md:p-10 rounded-r-2xl overflow-y-auto h-full lg:h-auto">
            <!-- Global Search Bar -->
            <div class="mb-6">
                <input type="text" id="global-search-input" placeholder="Search flashcards, notes, concepts..."
                    class="w-full p-3 rounded-lg border border-border-color input-themed focus:outline-none focus:ring-2 focus:ring-accent-blue">
            </div>

            <!-- View: Dashboard -->
            <section id="view-dashboard" class="view-section">
                <h1 class="text-3xl font-bold mb-6 text-primary">Welcome Back, <span id="dashboard-username"></span>!</h1>

                <!-- Quick Stats -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                    <div class="p-5 bg-secondary rounded-xl shadow-sm border border-border-color">
                        <p class="text-sm text-secondary">Daily Flashcards Due</p>
                        <p id="daily-queue-count" class="text-2xl font-bold text-primary mt-1">0 Flashcards</p>
                    </div>
                    <div class="p-5 bg-secondary rounded-xl shadow-sm border border-border-color">
                        <p class="text-sm text-secondary">Current Study Streak</p>
                        <p id="current-streak" class="text-2xl font-bold text-primary mt-1">ðŸ”¥ 0 Days</p>
                    </div>
                    <div class="p-5 bg-secondary rounded-xl shadow-sm border border-border-color">
                        <p class="text-sm text-secondary">Total Flashcards Mastered</p>
                        <p id="total-mastered-atoms" class="text-2xl font-bold text-primary mt-1">0</p>
                    </div>
                    <div class="p-5 bg-secondary rounded-xl shadow-sm border border-border-color">
                        <p class="text-sm text-secondary">Upcoming Events (7 days)</p>
                        <p id="upcoming-events-count" class="text-2xl font-bold text-primary mt-1">0</p>
                    </div>
                </div>

                <!-- Daily Review & Challenge -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <div class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color">
                        <h2 class="text-2xl font-bold text-primary mb-4">Daily Review</h2>
                        <!-- Added max-h-48 and overflow-y-auto to ensure scrollability for daily-queue-list -->
                        <ul id="daily-queue-list" class="space-y-3 max-h-48 overflow-y-auto pr-2">
                            <!-- Flashcards will be injected here by JS -->
                        </ul>
                        <div class="mt-6 flex flex-col sm:flex-row gap-3">
                            <button id="start-review-btn" class="button-primary px-5 py-3 rounded-lg font-semibold flex-grow">Start Daily Review</button>
                            <button id="quick-add-atom-btn-dashboard" class="bg-blue-100 text-accent-blue px-5 py-3 rounded-lg font-semibold hover:bg-blue-200 transition-colors flex-grow">
                                <i class="fas fa-plus mr-2"></i>Quick Add Flashcard
                            </button>
                        </div>
                    </div>

                    <div class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color">
                        <h2 class="text-2xl font-bold text-primary mb-4">Daily Challenge</h2>
                        <p id="daily-challenge-text" class="text-secondary mb-3">Review 5 Flashcards to complete today's challenge!</p>
                        <div class="w-full bg-border-color rounded-full h-3 mb-2">
                            <div id="daily-challenge-progress" class="bg-accent-blue h-3 rounded-full" style="width: 0%;"></div>
                        </div>
                        <p id="daily-challenge-status" class="text-sm text-secondary mb-4">0/5 Flashcards Reviewed</p>
                        <button id="claim-challenge-btn" class="button-primary px-5 py-3 rounded-lg font-semibold w-full hidden">Claim Reward!</button>
                        <button id="study-weak-atoms-btn" class="bg-orange-100 text-orange-500 px-5 py-3 rounded-lg font-semibold w-full mt-3 hover:bg-orange-200 transition-colors">Study Weak Flashcards</button>
                    </div>
                </div>

                <!-- Recommended Flashcards -->
                <div class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color mb-8">
                    <h2 class="text-2xl font-bold text-primary mb-4">Recommended for You</h2>
                    <!-- Added max-h-48 and overflow-y-auto for scrollability -->
                    <div id="recommended-atoms-list" class="space-y-3 max-h-48 overflow-y-auto pr-2">
                        <!-- Recommended Flashcards will be injected here by JS -->
                    </div>
                </div>

                <!-- Backup Reminder -->
                <div id="backup-reminder" class="bg-yellow-100 text-yellow-800 p-4 rounded-lg flex items-center justify-between shadow-sm hidden">
                    <p class="text-sm font-medium">
                        <i class="fas fa-exclamation-triangle mr-2"></i>
                        It's been a while since your last data backup. Remember to export your data in settings!
                    </p>
                    <button class="text-yellow-800 text-sm font-semibold py-1 px-3 rounded-md hover:bg-yellow-200 transition-colors" onclick="navigate('settings')">Go to Settings</button>
                </div>

            </section>

            <!-- View: Calendar -->
            <section id="view-calendar" class="view-section hidden">
                <h1 class="text-3xl font-bold mb-6 text-primary">Your Calendar & Events</h1>
                <div class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color mb-8">
                    <div class="flex justify-between items-center mb-6">
                        <button id="prev-month-btn" class="p-2 rounded-full hover:bg-border-color text-primary"><i class="fas fa-chevron-left"></i></button>
                        <h2 id="current-month-year" class="text-xl font-semibold text-primary">June 2025</h2>
                        <button id="next-month-btn" class="p-2 rounded-full hover:bg-border-color text-primary"><i class="fas fa-chevron-right"></i></button>
                    </div>
                    <div class="grid grid-cols-7 text-center font-semibold text-secondary mb-4">
                        <div>Sun</div>
                        <div>Mon</div>
                        <div>Tue</div>
                        <div>Wed</div>
                        <div>Thu</div>
                        <div>Fri</div>
                        <div>Sat</div>
                    </div>
                    <div id="calendar-grid" class="calendar-grid mb-6">
                        <!-- Calendar days will be injected here by JS -->
                    </div>

                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-primary">Events for <span id="selected-day-display">Today</span></h3>
                        <button id="add-event-btn" class="button-primary px-4 py-2 rounded-lg font-semibold text-sm">
                            <i class="fas fa-plus mr-2"></i>Add Event
                        </button>
                    </div>
                    <!-- Added max-h-64 and overflow-y-auto for scrollability -->
                    <ul id="events-list-for-day" class="space-y-3 events-for-day-list max-h-64 overflow-y-auto pr-2">
                        <!-- Events for selected day will be injected here by JS -->
                    </ul>
                </div>
            </section>

            <!-- View: Library -->
            <section id="view-library" class="view-section hidden">
                <h1 class="text-3xl font-bold mb-6 text-primary">Your Learning Library</h1>

                <div class="mb-8">
                    <button id="quick-add-atom-btn-library" class="button-primary px-5 py-3 rounded-lg font-semibold w-full sm:w-auto">
                        <i class="fas fa-plus mr-2"></i>Quick Add Flashcard
                    </button>
                </div>

                <h2 class="text-2xl font-bold text-primary mb-4">Your Subjects</h2>
                <div id="empty-library-message" class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color text-center text-secondary hidden">
                    <p class="mb-3">No subjects created yet. Start by adding your first flashcard!</p>
                    <button class="bg-accent-blue text-white px-4 py-2 rounded-lg hover:bg-accent-blue-hover transition-colors font-semibold" onclick="document.getElementById('quick-add-atom-btn-library').click()">Add First Flashcard</button>
                </div>
                <!-- Added overflow-y-auto to subject-grid to enable scrolling if many subjects -->
                <div id="subject-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-8 overflow-y-auto max-h-96">
                    <!-- Subjects will be injected here by JS -->
                </div>

                <h2 class="text-2xl font-bold text-primary mb-4" id="ai-materials-section">AI-Generated Materials</h2>
                <div id="empty-ai-materials-message" class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color text-center text-secondary hidden">
                    <p class="mb-3">No AI-generated materials yet. Head over to the AI Learning Studio to create some!</p>
                    <button class="bg-accent-blue text-white px-4 py-2 rounded-lg hover:bg-accent-blue-hover transition-colors font-semibold" onclick="navigate('ai-learning')">Go to AI Learning Studio</button>
                </div>
                <!-- Added max-h-96 and overflow-y-auto for scrollability -->
                <div id="ai-materials-list" class="space-y-3 max-h-96 overflow-y-auto pr-2">
                    <!-- AI Materials will be injected here by JS -->
                </div>
            </section>

            <!-- View: AI Learning Studio -->
            <section id="view-ai-learning" class="view-section hidden">
                <h1 class="text-3xl font-bold mb-6 text-primary">AI Learning Studio</h1>
                <div class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color">
                    <div class="flex items-center justify-between mb-4">
                        <label for="ai-input-mode-toggle" class="text-primary font-semibold">Input Mode:</label>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" value="" id="ai-input-mode-toggle" class="sr-only peer">
                            <div class="w-11 h-6 bg-border-color peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-accent-blue rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-border-color after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent-blue"></div>
                            <span class="ml-3 text-sm font-medium text-primary">Topic / Text</span>
                        </label>
                    </div>

                    <label for="ai-input-content" id="ai-input-content-label" class="block text-primary text-sm font-semibold mb-2">Provide text, a topic, or questions for the AI to process:</label>
                    <textarea id="ai-input-content" rows="6" class="w-full p-3 border rounded-lg resize-y input-themed"
                        placeholder="Enter text, a topic, or specific questions here... e.g., 'Explain blockchain technology', 'Summarize World War 2 causes', or 'Quiz me on React hooks'."></textarea>

                    <div class="mt-4">
                        <label for="ai-content-subject-select" class="block text-primary text-sm font-semibold mb-2">Assign to Subject (for flashcards/notes):</label>
                        <div class="flex gap-2">
                            <select id="ai-content-subject-select" class="flex-grow p-2 border rounded-lg bg-input-bg text-input-text">
                                <option value="">Select or Add New Subject</option>
                            </select>
                            <input type="text" id="ai-content-new-subject-input" placeholder="New subject name" class="p-2 border rounded-lg hidden flex-grow input-themed">
                            <button id="toggle-ai-content-new-subject-input" class="bg-blue-100 text-accent-blue px-4 py-2 rounded-lg font-semibold text-sm hover:bg-blue-200 transition-colors">Add New Subject</button>
                        </div>
                    </div>

                    <!-- NEW: Quiz Settings Container -->
                    <div id="quiz-settings-container" class="hidden bg-gray-50 p-4 rounded-lg border border-border-color mt-4 space-y-3">
                        <h4 class="font-semibold text-primary">Quiz Settings</h4>
                        <div>
                            <label for="quiz-question-count-input" class="block text-primary text-sm font-semibold mb-2">Number of Questions:</label>
                            <input type="number" id="quiz-question-count-input" class="w-full p-2 border border-border-color rounded-lg input-themed" value="5" min="1" max="15">
                        </div>
                        <div>
                            <label for="quiz-difficulty-select" class="block text-primary text-sm font-semibold mb-2">Difficulty:</label>
                            <select id="quiz-difficulty-select" class="w-full p-2 border border-border-color rounded-lg bg-input-bg text-input-text">
                                <option value="easy">Easy</option>
                                <option value="medium" selected>Medium</option>
                                <option value="hard">Hard</option>
                            </select>
                        </div>
                    </div>


                    <div class="flex flex-wrap gap-3 mt-6 justify-center sm:justify-start">
                        <button id="generate-ai-notes-btn" class="button-primary px-4 py-2 rounded-lg font-semibold flex-grow sm:flex-grow-0">Generate Notes</button>
                        <button id="generate-notes-flashcards-btn" class="button-primary px-4 py-2 rounded-lg font-semibold flex-grow sm:flex-grow-0">Generate Flashcards</button>
                        <button id="generate-quiz-btn" class="button-primary px-4 py-2 rounded-lg font-semibold flex-grow sm:flex-grow-0">Generate Quiz</button>
                        <button id="extract-keywords-btn" class="button-primary px-4 py-2 rounded-lg font-semibold flex-grow sm:flex-grow-0">Extract Keywords</button>
                        <button id="predict-exam-questions-btn" class="button-primary px-4 py-2 rounded-lg font-semibold flex-grow sm:flex-grow-0">Predict Exam Questions</button>
                        <button id="summarize-content-btn" class="button-primary px-4 py-2 rounded-lg font-semibold flex-grow sm:flex-grow-0">Summarize Content</button>
                    </div>

                    <p id="ai-generation-status" class="text-center text-secondary mt-4 hidden">Generating... Please wait...</p>

                    <div id="ai-generated-output" class="bg-primary p-5 rounded-xl shadow-sm border border-border-color mt-8 hidden">
                        <h3 id="ai-output-title" class="text-xl font-bold text-primary mb-4">Generated Content</h3>
                        <!-- Added overflow-y-auto for scrollability of generated content -->
                        <div id="ai-output-content-display" class="text-secondary prose max-w-none max-h-96 overflow-y-auto pr-2">
                            <!-- AI generated content will be displayed here -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- View: Mind Map -->
            <section id="view-mind-map" class="view-section hidden">
                <h1 class="text-3xl font-bold mb-6 text-primary">Interactive Mind Map</h1>
                <div class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color">
                    <div class="flex flex-wrap gap-3 mb-4 items-end">
                        <div>
                            <label for="mind-map-node-text-input" class="block text-primary text-sm font-semibold mb-1">New Node Text:</label>
                            <input type="text" id="mind-map-node-text-input" placeholder="Enter node text" class="p-2 border rounded-lg input-themed">
                        </div>
                        <button id="mind-map-add-node-btn" class="button-primary px-4 py-2 rounded-lg font-semibold">Add Node</button>
                        <button id="mind-map-clear-all-btn" class="bg-red-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-red-600">Clear All</button>
                        <button id="mind-map-save-btn" class="bg-green-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-green-600">Save Map</button>
                        <select id="mind-map-load-select" class="p-2 border rounded-lg bg-input-bg text-input-text">
                            <option value="">Load Map</option>
                            <!-- Options will be populated by JS -->
                        </select>
                    </div>
                    <!-- Mind Map Canvas container for fixed height, content inside scrolls -->
                    <div class="relative w-full overflow-hidden rounded-lg border border-border-color" style="height: 500px;">
                        <canvas id="mind-map-canvas" class="w-full h-full block"></canvas>
                    </div>
                    <p class="text-xs text-secondary mt-4">
                        Drag nodes to move. Click a node, then another to connect. Double-click a node to edit text.
                    </p>
                </div>
            </section>

            <!-- View: Glossary -->
            <section id="view-glossary" class="view-section hidden">
                <h1 class="text-3xl font-bold mb-6 text-primary">Your Glossary</h1>
                <div class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color">
                    <input type="text" id="glossary-search-input" placeholder="Search terms..." class="w-full p-3 rounded-lg border input-themed mb-6">
                    <div id="empty-glossary-message" class="text-center text-secondary hidden">
                        <p>Your glossary is empty. Extract keywords using the AI Learning Studio!</p>
                    </div>
                    <!-- Added max-h-96 and overflow-y-auto for scrollability -->
                    <div id="glossary-list" class="space-y-4 max-h-96 overflow-y-auto pr-2">
                        <!-- Glossary terms will be injected here by JS -->
                    </div>
                </div>
            </section>

            <!-- View: Analytics -->
            <section id="view-analytics" class="view-section hidden">
                <h1 class="text-3xl font-bold mb-6 text-primary">Your Progress & Analytics</h1>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <div class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color flex flex-col items-center justify-center">
                        <h2 class="text-xl font-bold text-primary mb-4">Flashcard Mastery Distribution</h2>
                        <div class="w-full max-w-xs h-64 flex items-center justify-center">
                            <canvas id="masteryChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color flex flex-col items-center justify-center">
                        <h2 class="text-xl font-bold text-primary mb-4">Study Activity (Last 7 Days)</h2>
                        <div class="w-full h-64 flex items-center justify-center">
                            <canvas id="activityChart"></canvas>
                        </div>
                    </div>
                    <div class="col-span-full bg-secondary p-6 rounded-xl shadow-sm border border-border-color flex flex-col items-center justify-center">
                        <h2 class="text-xl font-bold text-primary mb-4">Knowledge Growth Over Time</h2>
                        <div class="w-full h-64 flex items-center justify-center">
                            <canvas id="growthChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-primary">Your Learning Goals</h2>
                    <button id="add-goal-btn" class="button-primary px-4 py-2 rounded-lg font-semibold text-sm">
                        <i class="fas fa-plus mr-2"></i>Add Goal
                    </button>
                </div>
                <div id="empty-goals-message" class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color text-center text-secondary hidden">
                    <p>No learning goals set yet. Set a goal to track your long-term progress!</p>
                </div>
                <!-- Added max-h-64 and overflow-y-auto for scrollability -->
                <div id="goals-list" class="space-y-4 max-h-64 overflow-y-auto pr-2">
                    <!-- Goals will be injected here by JS -->
                </div>
            </section>

            <!-- View: Achievements -->
            <section id="view-achievements" class="view-section hidden">
                <h1 class="text-3xl font-bold mb-6 text-primary">Your Achievements</h1>
                <div id="empty-achievements-message" class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color text-center text-secondary hidden">
                    <p>No achievements unlocked yet. Keep learning and reviewing to earn your first badge!</p>
                </div>
                <!-- Added max-h-[calc(100vh-200px)] and overflow-y-auto for scrollability -->
                <div id="achievements-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 max-h-[calc(100vh-200px)] overflow-y-auto pr-2">
                    <!-- Achievements will be injected here by JS -->
                </div>
            </section>

            <!-- View: Study Session -->
            <section id="view-study" class="view-section hidden flex flex-col items-center justify-center min-h-[calc(100vh-100px)]">
                <div class="w-full mb-6 text-center">
                    <div class="w-full bg-border-color rounded-full h-2.5">
                        <div id="study-progress-bar" class="bg-accent-blue h-2.5 rounded-full" style="width: 0%;"></div>
                    </div>
                    <p id="study-progress-text" class="text-sm text-secondary mt-2">Flashcard 0 of 0</p>
                </div>

                <div id="flashcard-container" class="flashcard-container w-full max-w-md mx-auto">
                    <div class="flashcard">
                        <div class="flashcard-face flashcard-front rounded-xl">
                            <p class="text-sm font-medium text-secondary mb-2" id="card-subject-front">Subject</p>
                            <!-- Added overflow-y-auto to flashcard content -->
                            <h3 id="card-question" class="text-2xl font-semibold text-primary mb-4 break-words overflow-y-auto max-h-48"></h3>
                            <button id="show-answer-btn" class="button-primary px-6 py-3 rounded-lg font-semibold mt-4 shadow-md">Show Answer</button>
                        </div>
                        <div class="flashcard-face flashcard-back rounded-xl">
                            <p class="text-sm font-medium text-secondary mb-2" id="card-subject-back">Subject</p>
                            <h3 class="text-2xl font-semibold text-primary mb-4 break-words">Answer:</h3>
                            <!-- Added overflow-y-auto to flashcard content -->
                            <p id="card-answer" class="text-lg text-primary mb-6 break-words overflow-y-auto max-h-48"></p>
                            <div class="grid grid-cols-2 sm:grid-cols-4 gap-3 w-full">
                                <button class="recall-btn px-4 py-2 rounded-lg font-semibold bg-red-500 text-white hover:bg-red-600 transition-colors" data-rating="0">Forgot</button>
                                <button class="recall-btn px-4 py-2 rounded-lg font-semibold bg-orange-500 text-white hover:bg-orange-600 transition-colors" data-rating="1">Struggled</button>
                                <button class="recall-btn px-4 py-2 rounded-lg font-semibold bg-yellow-500 text-white hover:bg-yellow-600 transition-colors" data-rating="2">Good</button>
                                <button class="recall-btn px-4 py-2 rounded-lg font-semibold bg-green-500 text-white hover:bg-green-600 transition-colors" data-rating="3">Perfect</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- View: Focus Tools -->
            <section id="view-focus" class="view-section hidden">
                <h1 class="text-3xl font-bold mb-6 text-primary">Focus Tools</h1>
                <div class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color mb-8 text-center">
                    <h2 class="text-2xl font-bold text-primary mb-4">Pomodoro Timer</h2>
                    <div class="text-6xl font-mono font-bold text-accent-blue mb-4" id="pomodoro-timer">25:00</div>
                    <p id="pomodoro-status" class="text-secondary mb-6">Time to focus!</p>
                    <div class="flex justify-center gap-4">
                        <button id="pomodoro-start" class="button-primary px-6 py-3 rounded-lg font-semibold">Start</button>
                        <button id="pomodoro-pause" class="bg-orange-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-orange-600">Pause</button>
                        <button id="pomodoro-reset" class="bg-gray-400 text-white px-6 py-3 rounded-lg font-semibold hover:bg-gray-500">Reset</button>
                    </div>
                </div>

                <div class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color">
                    <h2 class="text-2xl font-bold text-primary mb-4">Ambient Soundscapes</h2>
                    <!-- Added overflow-y-auto to soundscapes for scrollability -->
                    <div id="soundscapes" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 max-h-64 overflow-y-auto pr-2">
                        <!-- Soundscape buttons injected by JS -->
                    </div>
                </div>
            </section>

            <!-- View: Learning Hub -->
            <section id="view-learning-hub" class="view-section hidden">
                <h1 class="text-3xl font-bold mb-6 text-primary">Learning Hub: Master Your Learning</h1>
                <div class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color mb-8">
                    <!-- Added overflow-x-auto to tab-buttons for horizontal scroll on small screens -->
                    <div class="flex flex-wrap gap-2 mb-6 border-b border-border-color pb-4 overflow-x-auto">
                        <button class="tab-button px-4 py-2 rounded-lg font-semibold text-primary hover:bg-border-color transition-colors" data-category="auralearnBasics">AuraLearn Basics</button>
                        <button class="tab-button px-4 py-2 rounded-lg font-semibold text-primary hover:bg-border-color transition-colors" data-category="techniques">Learning Techniques</button>
                        <button class="tab-button px-4 py-2 rounded-lg font-semibold text-primary hover:bg-border-color transition-colors" data-category="memorization">Memorization</button>
                        <button class="tab-button px-4 py-2 rounded-lg font-semibold text-primary hover:bg-border-color transition-colors" data-category="biases">Cognitive Biases</button>
                        <button class="tab-button px-4 py-2 rounded-lg font-semibold text-primary hover:bg-border-color transition-colors" data-category="productivity">Productivity</button>
                        <button class="tab-button px-4 py-2 rounded-lg font-semibold text-primary hover:bg-border-color transition-colors" data-category="examPrep">Exam Prep</button>
                        <button class="tab-button px-4 py-2 rounded-lg font-semibold text-primary hover:bg-border-color transition-colors" data-category="advanced">Advanced Concepts</button>
                    </div>
                    <!-- Added max-h-[calc(100vh-300px)] and overflow-y-auto for scrollability -->
                    <div id="learning-hub-content" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-[calc(100vh-300px)] overflow-y-auto pr-2">
                        <!-- Learning content will be injected here by JS -->
                    </div>
                </div>
            </section>

            <!-- View: Settings -->
            <section id="view-settings" class="view-section hidden">
                <h1 class="text-3xl font-bold mb-6 text-primary">Settings</h1>

                <div class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color mb-8">
                    <h2 class="text-2xl font-bold text-primary mb-4">User Profile</h2>
                    <div class="mb-4">
                        <label for="username-input" class="block text-primary text-sm font-semibold mb-2">Your Name:</label>
                        <input type="text" id="username-input" class="w-full p-3 border rounded-lg input-themed" placeholder="Enter your name">
                    </div>
                    <button id="save-username-btn" class="button-primary px-5 py-2 rounded-lg font-semibold">Save Name</button>
                </div>

                <div class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color mb-8">
                    <h2 class="text-2xl font-bold text-primary mb-4">Spaced Repetition Intervals</h2>
                    <p class="text-secondary text-sm mb-4">Adjust the intervals (in days) for flashcard review based on your recall rating.</p>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label for="interval-perfect" class="block text-primary text-sm font-semibold mb-2">Perfect Recall (Days):</label>
                            <input type="number" id="interval-perfect" class="w-full p-3 border rounded-lg input-themed" value="7" min="0.1" step="0.1">
                        </div>
                        <div>
                            <label for="interval-good" class="block text-primary text-sm font-semibold mb-2">Good Recall (Days):</label>
                            <input type="number" id="interval-good" class="w-full p-3 border rounded-lg input-themed" value="3" min="0.1" step="0.1">
                        </div>
                        <div>
                            <label for="interval-struggled" class="block text-primary text-sm font-semibold mb-2">Struggled (Days):</label>
                            <input type="number" id="interval-struggled" class="w-full p-3 border rounded-lg input-themed" value="1" min="0.1" step="0.1">
                        </div>
                        <div>
                            <label for="interval-forgot" class="block text-primary text-sm font-semibold mb-2">Forgot (Days):</label>
                            <input type="number" id="interval-forgot" class="w-full p-3 border rounded-lg input-themed" value="0.25" min="0.1" step="0.1">
                        </div>
                    </div>
                    <button id="save-intervals-btn" class="button-primary px-5 py-2 rounded-lg font-semibold">Save Intervals</button>
                </div>

                <div class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color mb-8">
                    <h2 class="text-2xl font-bold text-primary mb-4">Themes</h2>
                    <p class="text-secondary text-sm mb-4">Personalize your AuraLearn experience.</p>
                    <!-- Added more themes here as buttons. Styling will be in style.css -->
                    <div class="flex flex-wrap gap-4">
                        <button data-theme="light" class="theme-btn border-2 border-border-color p-3 rounded-lg text-primary font-semibold hover:opacity-80 transition-opacity">Light</button>
                        <button data-theme="dark" class="theme-btn border-2 border-border-color p-3 rounded-lg text-primary font-semibold hover:opacity-80 transition-opacity">Dark</button>
                        <button data-theme="vibrant" class="theme-btn border-2 border-border-color p-3 rounded-lg text-primary font-semibold hover:opacity-80 transition-opacity">Vibrant</button>
                        <button data-theme="forest-green" class="theme-btn border-2 border-border-color p-3 rounded-lg text-primary font-semibold hover:opacity-80 transition-opacity">Forest Green</button>
                        <button data-theme="ocean-blue" class="theme-btn border-2 border-border-color p-3 rounded-lg text-primary font-semibold hover:opacity-80 transition-opacity">Ocean Blue</button>
                        <button data-theme="warm-sunset" class="theme-btn border-2 border-border-color p-3 rounded-lg text-primary font-semibold hover:opacity-80 transition-opacity">Warm Sunset</button>
                        <button data-theme="cool-breeze" class="theme-btn border-2 border-border-color p-3 rounded-lg text-primary font-semibold hover:opacity-80 transition-opacity">Cool Breeze</button>
                        <button data-theme="mono-contrast" class="theme-btn border-2 border-border-color p-3 rounded-lg text-primary font-semibold hover:opacity-80 transition-opacity">Mono Contrast</button>
                    </div>
                </div>

                <div class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color">
                    <h2 class="text-2xl font-bold text-primary mb-4">Data Management</h2>
                    <p class="text-secondary text-sm mb-4">Export your data for backup or import previously saved data.</p>
                    <div class="flex flex-col sm:flex-row gap-4">
                        <button id="export-data-btn" class="button-primary px-5 py-2 rounded-lg font-semibold">Export Data</button>
                        <input type="file" id="import-data-input" accept=".json" class="hidden">
                        <button id="import-data-btn" class="bg-gray-400 text-white px-5 py-2 rounded-lg font-semibold hover:bg-gray-500">Import Data</button>
                    </div>
                </div>
            </section>

            <!-- View: Tutorial -->
            <section id="view-tutorial" class="view-section hidden">
                <h1 class="text-3xl font-bold mb-6 text-primary">AuraLearn Tutorial & Guide</h1>
                <div class="bg-secondary p-6 rounded-xl shadow-sm border border-border-color">
                    <h2 class="text-2xl font-bold text-primary mb-4">Interactive Tours</h2>
                    <p class="text-secondary mb-4">Take a quick tour of key features to get started.</p>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-8">
                        <button class="button-primary px-5 py-3 rounded-lg font-semibold tutorial-tour-btn" data-tour="dashboard">Dashboard Tour</button>
                        <button class="button-primary px-5 py-3 rounded-lg font-semibold tutorial-tour-btn" data-tour="library">Library & Flashcards Tour</button>
                        <button class="button-primary px-5 py-3 rounded-lg font-semibold tutorial-tour-btn" data-tour="ai-learning">AI Learning Studio Tour</button>
                        <button class="button-primary px-5 py-3 rounded-lg font-semibold tutorial-tour-btn" data-tour="focus-tools">Focus Tools Tour</button>
                    </div>

                    <h2 class="text-2xl font-bold text-primary mb-4">Detailed Guides</h2>
                    <p class="text-secondary mb-4">Dive deeper into specific concepts and features.</p>
                    <!-- Added max-h-96 and overflow-y-auto for scrollability -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 max-h-96 overflow-y-auto pr-2">
                        <div class="bg-primary p-4 rounded-lg border border-border-color cursor-pointer hover:bg-border-color transition-colors" data-guide="srs-deep-dive">
                            <h3 class="font-semibold text-primary">Deep Dive: Spaced Repetition System (SRS)</h3>
                            <p class="text-sm text-secondary">Understand how AuraLearn optimizes your memory.</p>
                        </div>
                        <div class="bg-primary p-4 rounded-lg border border-border-color cursor-pointer hover:bg-border-color transition-colors" data-guide="customizing-ai">
                            <h3 class="font-semibold text-primary">Customizing AI Generation</h3>
                            <p class="text-sm text-secondary">Tips for getting the best results from the AI Studio.</p>
                        </div>
                        <div class="bg-primary p-4 rounded-lg border border-border-color cursor-pointer hover:bg-border-color transition-colors" data-guide="goal-setting">
                            <h3 class="font-semibold text-primary">Effective Goal Setting</h3>
                            <p class="text-sm text-secondary">Learn how to set and achieve your learning goals.</p>
                        </div>
                        <div class="bg-primary p-4 rounded-lg border border-border-color cursor-pointer hover:bg-border-color transition-colors" data-guide="data-management">
                            <h3 class="font-semibold text-primary">Data Backup & Import</h3>
                            <p class="text-sm text-secondary">Keep your learning progress safe and sound.</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modals -->

    <!-- Global Search Results Modal -->
    <div id="search-results-modal" class="modal-overlay hidden">
        <div class="modal-content w-full max-w-2xl">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-primary">Search Results</h3>
                <button id="close-search-results-modal" class="text-secondary hover:text-primary"><i class="fas fa-times text-lg"></i></button>
            </div>
            <div id="search-results-content" class="space-y-3 max-h-96 overflow-y-auto pr-2">
                <!-- Results will be injected here -->
            </div>
        </div>
    </div>

    <!-- Quick Add Flashcard Modal -->
    <div id="quick-add-atom-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-primary">Quick Add Flashcard</h3>
                <button id="close-quick-add-modal" class="text-secondary hover:text-primary"><i class="fas fa-times text-lg"></i></button>
            </div>
            <div class="mb-4">
                <label for="quick-add-subject" class="block text-primary text-sm font-semibold mb-2">Subject:</label>
                <div class="flex gap-2">
                    <select id="quick-add-subject" class="flex-grow p-2 border rounded-lg bg-input-bg text-input-text">
                        <option value="">Select or Add New Subject</option>
                    </select>
                    <input type="text" id="new-subject-input" placeholder="New subject name" class="p-2 border rounded-lg hidden flex-grow input-themed">
                    <button id="toggle-new-subject-input" class="bg-blue-100 text-accent-blue px-4 py-2 rounded-lg font-semibold text-sm hover:bg-blue-200 transition-colors">Add New Subject</button>
                </div>
            </div>
            <div class="mb-4">
                <label for="quick-add-question" class="block text-primary text-sm font-semibold mb-2">Question/Concept:</label>
                <textarea id="quick-add-question" rows="3" class="w-full p-3 border rounded-lg resize-y input-themed" placeholder="e.g., 'What is the capital of France?'"></textarea>
            </div>
            <div class="mb-6">
                <label for="quick-add-answer" class="block text-primary text-sm font-semibold mb-2">Answer/Explanation:</label>
                <textarea id="quick-add-answer" rows="5" class="w-full p-3 border rounded-lg resize-y input-themed" placeholder="e.g., 'Paris'"></textarea>
            </div>
            <button id="add-atom-btn" class="button-primary px-5 py-2 rounded-lg font-semibold w-full">Add Flashcard</button>
        </div>
    </div>

    <!-- Add/Edit Event Modal -->
    <div id="add-edit-event-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 id="event-modal-title" class="text-xl font-bold text-primary">Add New Event</h3>
                <button id="close-event-modal" class="text-secondary hover:text-primary"><i class="fas fa-times text-lg"></i></button>
            </div>
            <div class="mb-4">
                <label for="event-title-input" class="block text-primary text-sm font-semibold mb-2">Event Title:</label>
                <input type="text" id="event-title-input" class="w-full p-3 border rounded-lg input-themed" placeholder="e.g., 'Physics Exam'">
            </div>
            <div class="mb-4">
                <label for="event-date-input" class="block text-primary text-sm font-semibold mb-2">Date:</label>
                <input type="date" id="event-date-input" class="w-full p-3 border rounded-lg input-themed">
            </div>
            <div class="mb-4">
                <label for="event-time-input" class="block text-primary text-sm font-semibold mb-2">Time (Optional):</label>
                <input type="time" id="event-time-input" class="w-full p-3 border rounded-lg input-themed">
            </div>
            <div class="mb-4">
                <label for="event-type-select" class="block text-primary text-sm font-semibold mb-2">Event Type:</label>
                <select id="event-type-select" class="w-full p-3 border rounded-lg bg-input-bg text-input-text">
                    <option value="assignment">Assignment</option>
                    <option value="exam">Exam</option>
                    <option value="study">Study Session</option>
                    <option value="other">Other</option>
                </select>
            </div>
            <div class="mb-6">
                <label for="event-notes-input" class="block text-primary text-sm font-semibold mb-2">Notes (Optional):</label>
                <textarea id="event-notes-input" rows="3" class="w-full p-3 border rounded-lg resize-y input-themed" placeholder="Any additional details..."></textarea>
            </div>
            <div class="flex justify-end gap-3">
                <button id="delete-event-btn" class="bg-red-500 text-white px-5 py-2 rounded-lg font-semibold hover:bg-red-600 hidden">Delete</button>
                <button id="save-event-btn" class="button-primary px-5 py-2 rounded-lg font-semibold">Save Event</button>
            </div>
        </div>
    </div>


    <!-- Add Goal Modal -->
    <div id="add-goal-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-primary">Set New Learning Goal</h3>
                <button id="close-add-goal-modal" class="text-secondary hover:text-primary"><i class="fas fa-times text-lg"></i></button>
            </div>
            <div class="mb-4">
                <label for="goal-name-input" class="block text-primary text-sm font-semibold mb-2">Goal Name:</label>
                <input type="text" id="goal-name-input" class="w-full p-3 border rounded-lg input-themed" placeholder="e.g., 'Master Python Fundamentals'">
            </div>
            <div class="mb-4">
                <label for="goal-target-type" class="block text-primary text-sm font-semibold mb-2">Target Type:</label>
                <select id="goal-target-type" class="w-full p-3 border rounded-lg bg-input-bg text-input-text">
                    <option value="flashcards">Mastered Flashcards</option>
                    <option value="time">Study Time (Hours/Week)</option>
                </select>
            </div>
            <div class="mb-4">
                <label for="goal-target-value" class="block text-primary text-sm font-semibold mb-2">Target Value:</label>
                <input type="number" id="goal-target-value" class="w-full p-3 border rounded-lg input-themed" placeholder="e.g., 100 or 5">
            </div>
            <div class="mb-6">
                <label for="goal-end-date" class="block text-primary text-sm font-semibold mb-2">End Date:</label>
                <input type="date" id="goal-end-date" class="w-full p-3 border rounded-lg input-themed">
            </div>
            <button id="create-goal-btn" class="button-primary px-5 py-2 rounded-lg font-semibold w-full">Create Goal</button>
        </div>
    </div>

    <!-- Detail Modal (for Learning Hub, AI Materials, Flashcards) -->
    <div id="detail-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 id="detail-title" class="text-xl font-bold text-primary">Detail Title</h3>
                <button id="close-detail-modal" class="text-secondary hover:text-primary"><i class="fas fa-times text-lg"></i></button>
            </div>
            <div id="detail-loading" class="text-center text-secondary py-8">
                <i class="fas fa-spinner fa-spin text-4xl"></i>
                <p class="mt-4">Loading details...</p>
            </div>
            <!-- Added max-h-[calc(90vh-100px)] and overflow-y-auto for scrollability -->
            <div id="detail-content-text" class="text-secondary prose max-w-none text-base max-h-[calc(90vh-100px)] overflow-y-auto pr-2">
                <!-- Detailed content will be injected here by JS -->
            </div>
        </div>
    </div>

    <!-- Subject Detail Modal -->
    <div id="subject-detail-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 id="subject-detail-title" class="text-xl font-bold text-primary">Subject Flashcards</h3>
                <button id="close-subject-detail-modal" class="text-secondary hover:text-primary"><i class="fas fa-times text-lg"></i></button>
            </div>
            <div id="subject-atoms-list" class="space-y-3 max-h-96 overflow-y-auto pr-2">
                <!-- Flashcards for the selected subject will be injected here by JS -->
            </div>
        </div>
    </div>

    <!-- Reflection Modal -->
    <div id="reflection-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-primary">Session Reflection</h3>
                <button id="close-reflection-modal" class="text-secondary hover:text-primary"><i class="fas fa-times text-lg"></i></button>
            </div>
            <p class="text-secondary mb-4">How do you feel about your study session today? What went well, what was challenging?</p>
            <textarea id="reflection-text" rows="6" class="w-full p-3 border rounded-lg resize-y input-themed" placeholder="Write your thoughts here..."></textarea>
            <button id="save-reflection-btn" class="button-primary px-5 py-2 rounded-lg font-semibold w-full mt-4">Save Reflection</button>
        </div>
    </div>

    <!-- Onboarding Modal -->
    <div id="onboarding-modal" class="modal-overlay hidden">
        <div class="modal-content text-center">
            <h3 class="text-2xl font-bold text-primary mb-4">Welcome to AuraLearn!</h3>
            <p id="onboarding-text" class="text-lg text-secondary mb-6">Let's set up your personalized learning journey.</p>

            <div id="onboarding-steps-container">
                <!-- Step 1 -->
                <div id="step-1" class="onboarding-step space-y-4">
                    <label for="goal-input" class="block text-primary text-base font-semibold">What are your primary learning goals?</label>
                    <input type="text" id="goal-input" class="w-full p-3 border rounded-lg input-themed" placeholder="e.g., 'Pass my final exams', 'Learn web development'">
                </div>
                <!-- Step 2 -->
                <div id="step-2" class="onboarding-step space-y-4 hidden">
                    <label for="time-input" class="block text-primary text-base font-semibold">How much time can you dedicate to learning each week (in hours)?</label>
                    <input type="number" id="time-input" class="w-full p-3 border rounded-lg input-themed" value="5" min="0" placeholder="e.g., 5">
                </div>
                <!-- Step 3 -->
                <div id="step-3" class="onboarding-step space-y-4 hidden">
                    <label for="subjects-input" class="block text-primary text-base font-semibold">What subjects or areas are you currently focusing on? (comma-separated)</label>
                    <input type="text" id="subjects-input" class="w-full p-3 border rounded-lg input-themed" placeholder="e.g., 'Mathematics, History, English Literature'">
                </div>
            </div>

            <div class="flex justify-center gap-4 mt-8">
                <button id="onboarding-next-btn" class="button-primary px-6 py-3 rounded-lg font-semibold">Next</button>
                <button id="onboarding-skip-btn" class="bg-gray-400 text-white px-6 py-3 rounded-lg font-semibold hover:bg-gray-500">Skip</button>
            </div>
        </div>
    </div>

    <!-- Quiz Modal -->
    <div id="quiz-modal" class="modal-overlay hidden">
        <div class="modal-content max-w-lg">
            <div class="flex justify-between items-center mb-4">
                <h3 id="quiz-title" class="text-xl font-bold text-primary">Quiz Title</h3>
                <button id="close-quiz-modal" class="text-secondary hover:text-primary"><i class="fas fa-times text-lg"></i></button>
            </div>

            <!-- Quiz Question Container -->
            <div id="quiz-question-container">
                <!-- Added overflow-y-auto for question text -->
                <p id="quiz-question-text" class="text-lg text-primary font-semibold mb-6 overflow-y-auto max-h-32"></p>
                <!-- Added overflow-y-auto for quiz options -->
                <div id="quiz-options" class="grid grid-cols-1 gap-3 mb-6 overflow-y-auto max-h-48">
                    <!-- Options injected here by JS -->
                </div>
                <p id="quiz-feedback" class="text-center font-semibold mb-4 hidden"></p>
                <button id="quiz-submit-answer-btn" class="button-primary px-5 py-2 rounded-lg font-semibold w-full">Submit Answer</button>
            </div>

            <!-- Quiz Results Container -->
            <div id="quiz-results-container" class="text-center hidden">
                <h3 class="text-2xl font-bold text-primary mb-4">Quiz Complete!</h3>
                <p id="quiz-score-display" class="text-xl font-semibold text-accent-blue mb-6">You scored: 0 / 0</p>
                <div class="flex flex-col sm:flex-row gap-3 justify-center">
                    <button id="quiz-retake-btn" class="button-primary px-5 py-2 rounded-lg font-semibold">Retake Quiz</button>
                    <button id="quiz-review-answers-btn" class="bg-gray-400 text-white px-5 py-2 rounded-lg font-semibold hover:bg-gray-500">Review Answers</button>
                </div>
            </div>

            <!-- Quiz Review Detail Container -->
            <div id="quiz-review-detail-container" class="hidden">
                <h3 class="text-xl font-bold text-primary mb-4">Review Your Answers</h3>
                <div id="quiz-review-list" class="space-y-4 max-h-80 overflow-y-auto pr-2">
                    <!-- Review items injected here by JS -->
                </div>
                <button id="quiz-back-to-results-btn" class="button-primary px-5 py-2 rounded-lg font-semibold w-full mt-6">Back to Results</button>
            </div>
        </div>
    </div>

    <!-- Tutorial Step Modal (for interactive tours and detailed guides) -->
    <div id="tutorial-step-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 id="tutorial-step-title" class="text-xl font-bold text-primary">Tutorial Step</h3>
                <button id="close-tutorial-step-modal" class="text-secondary hover:text-primary"><i class="fas fa-times text-lg"></i></button>
            </div>
            <!-- Added max-h-[calc(90vh-100px)] and overflow-y-auto for scrollability -->
            <div id="tutorial-step-content" class="text-secondary prose max-w-none text-base max-h-[calc(90vh-100px)] overflow-y-auto pr-2">
                <!-- Content will be injected here by JS -->
            </div>
            <div class="flex justify-between mt-6">
                <button id="tutorial-prev-btn" class="bg-gray-400 text-white px-5 py-2 rounded-lg font-semibold hover:bg-gray-500 hidden">Previous</button>
                <button id="tutorial-next-btn" class="button-primary px-5 py-2 rounded-lg font-semibold ml-auto">Next</button>
                <button id="tutorial-finish-btn" class="button-primary px-5 py-2 rounded-lg font-semibold ml-auto hidden">Finish Tour</button>
            </div>
        </div>
    </div>


    <!-- Global Notification Toast -->
    <div id="notification-toast" class="notification-toast hidden">
        This is a notification message.
    </div>

    <!-- Script -->
    <script src="script.js"></script>
</body>
</html>
