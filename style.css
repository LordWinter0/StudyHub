/* General body styling and font application */
body {
    font-family: 'Inter', sans-serif;
    background-color: #f8fafc; /* Default light theme background */
    color: #0f172a; /* Default light theme primary text color */
}

/* Theme Variables - Light Theme */
.theme-light {
    --bg-primary: #f8fafc;
    --bg-secondary: #ffffff;
    --text-primary: #0f172a;
    --text-secondary: #64748b;
    --border-color: #e2e8f0;
    --accent-blue: #2563eb;
    --accent-blue-hover: #1d4ed8;
    --nav-active-bg: #e2e8f0;
    --nav-active-text: #0f172a;
    --card-front-bg: #ffffff;
    --card-back-bg: #ffffff;
    --input-bg: #ffffff;
    --input-text: #0f172a;
    --text-red: #dc2626;
    --text-orange: #f97316;
    --text-yellow: #facc15;
    --text-green: #22c54a;
    --text-red-rgb: 220, 38, 38;
    --text-orange-rgb: 249, 115, 22;
    --text-yellow-rgb: 250, 204, 21;
    --text-green-rgb: 34, 197, 74;
    --list-item-bg: #ffffff;
    --list-item-border: #e2e8f0;
    --list-item-hover-bg: #f1f5f9;
    --canvas-bg: #f8fafc; /* For mind map canvas */
    --node-bg: #ffffff;
    --node-border: #e2e8f0;
    --node-text: #0f172a;
    --node-selected-border: var(--accent-blue);
    --connection-color: #64748b;
    --achievement-bg: #ffffff;
    --achievement-border: #e2e8f0;
    --achievement-unlocked-bg: #dcfce7; /* Light green for unlocked */
    --achievement-unlocked-text: #166534; /* Dark green for unlocked */
    --achievement-locked-bg: #f1f5f9; /* Light gray for locked */
    --achievement-locked-text: #64748b; /* Gray for locked */
    /* Calendar Colors */
    --calendar-day-bg: #ffffff;
    --calendar-day-hover-bg: #f1f5f9;
    --calendar-day-border: #e2e8f0;
    --calendar-day-text: #0f172a;
    --calendar-day-inactive-text: #cbd5e1; /* Gray-300 */
    --calendar-today-border: #2563eb; /* Accent blue */
    --calendar-selected-day-bg: #e0f2f7; /* Light blue */
    --event-assignment-color: #ef4444; /* Red-500 */
    --event-exam-color: #f97316; /* Orange-500 */
    --event-study-color: #22c54a; /* Green-500 */
    --event-other-color: #8b5cf6; /* Violet-500 */
    --calendar-event-dot: #94a3b8; /* Slate-400 */
}

/* Theme Variables - Dark Theme */
.theme-dark {
    --bg-primary: #1e293b;
    --bg-secondary: #334155;
    --text-primary: #f8fafc;
    --text-secondary: #94a3b8;
    --border-color: #475569;
    --accent-blue: #60a5fa;
    --accent-blue-hover: #3b82f6;
    --nav-active-bg: #475569;
    --nav-active-text: #f8fafc;
    --card-front-bg: #334155;
    --card-back-bg: #334155;
    --input-bg: #1e293b;
    --input-text: #f8fafc;
    --text-red: #ef4444;
    --text-orange: #fb923c;
    --text-yellow: #fde047;
    --text-green: #4ade80;
    --text-red-rgb: 239, 68, 68;
    --text-orange-rgb: 251, 146, 60;
    --text-yellow-rgb: 253, 224, 71;
    --text-green-rgb: 74, 222, 128;
    --list-item-bg: #2d3a4b;
    --list-item-border: #475569;
    --list-item-hover-bg: #37455a;
    --canvas-bg: #1e293b; /* For mind map canvas */
    --node-bg: #334155;
    --node-border: #475569;
    --node-text: #f8fafc;
    --node-selected-border: var(--accent-blue);
    --connection-color: #94a3b8;
    --achievement-bg: #334155;
    --achievement-border: #475569;
    --achievement-unlocked-bg: #22c55e; /* Green for unlocked */
    --achievement-unlocked-text: #f8fafc; /* White for unlocked */
    --achievement-locked-bg: #475569; /* Darker gray for locked */
    --achievement-locked-text: #94a3b8; /* Lighter gray for locked */
    /* Calendar Colors */
    --calendar-day-bg: #334155;
    --calendar-day-hover-bg: #475569;
    --calendar-day-border: #475569;
    --calendar-day-text: #f8fafc;
    --calendar-day-inactive-text: #64748b; /* Slate-500 */
    --calendar-today-border: #60a5fa; /* Accent blue */
    --calendar-selected-day-bg: #2d3a4b; /* Darker secondary */
    --event-assignment-color: #dc2626; /* Red-600 */
    --event-exam-color: #f59e0b; /* Amber-500 */
    --event-study-color: #16a34a; /* Green-600 */
    --event-other-color: #7c3aed; /* Violet-600 */
    --calendar-event-dot: #94a3b8; /* Slate-400 */
}

/* Theme Variables - Vibrant Theme */
.theme-vibrant {
    --bg-primary: #ecfeff;
    --bg-secondary: #e0f2f7;
    --text-primary: #083344;
    --text-secondary: #22d3ee;
    --border-color: #a5f3fc;
    --accent-blue: #0ea5e9;
    --accent-blue-hover: #0284c7;
    --nav-active-bg: #bae6fd;
    --nav-active-text: #083344;
    --card-front-bg: #ffffff;
    --card-back-bg: #ffffff;
    --input-bg: #ecfeff;
    --input-text: #083344;
    --text-red: #ef4444;
    --text-orange: #fb923c;
    --text-yellow: #fde047;
    --text-green: #4ade80;
    --text-red-rgb: 239, 68, 68;
    --text-orange-rgb: 251, 146, 60;
    --text-yellow-rgb: 253, 224, 71;
    --text-green-rgb: 74, 222, 128;
    --list-item-bg: #e0f2f7;
    --list-item-border: #a5f3fc;
    --list-item-hover-bg: #d1f4ff;
    --canvas-bg: #ecfeff; /* For mind map canvas */
    --node-bg: #e0f2f7;
    --node-border: #a5f3fc;
    --node-text: #083344;
    --node-selected-border: var(--accent-blue);
    --connection-color: #22d3ee;
    --achievement-bg: #e0f2f7;
    --achievement-border: #a5f3fc;
    --achievement-unlocked-bg: #67e8f9; /* Vibrant Cyan for unlocked */
    --achievement-unlocked-text: #0e7490; /* Dark Cyan for unlocked */
    --achievement-locked-bg: #a5f3fc; /* Lighter Cyan for locked */
    --achievement-locked-text: #22d3ee; /* Cyan for locked */
    /* Calendar Colors */
    --calendar-day-bg: #e0f2f7;
    --calendar-day-hover-bg: #d1f4ff;
    --calendar-day-border: #a5f3fc;
    --calendar-day-text: #083344;
    --calendar-day-inactive-text: #67e8f9; /* Cyan-400 */
    --calendar-today-border: #0ea5e9; /* Accent blue */
    --calendar-selected-day-bg: #bae6fd; /* Lightest blue */
    --event-assignment-color: #ef4444; /* Red-500 */
    --event-exam-color: #fb923c; /* Orange-500 */
    --event-study-color: #4ade80; /* Green-500 */
    --event-other-color: #a78bfa; /* Violet-400 */
    --calendar-event-dot: #22d3ee; /* Cyan-500 */
}

/* General element styling using theme variables */
body {
    background-color: var(--bg-primary);
    color: var(--text-primary);
}
aside,
header,
.bg-secondary,
.modal > div {
    background-color: var(--bg-secondary);
    border-color: var(--border-color);
}
.text-primary {
    color: var(--text-primary);
}
.text-secondary {
    color: var(--text-secondary);
}
.border-border-color {
    border-color: var(--border-color);
}

/* Specific hover state for nav items, using theme var */
.nav-item:hover {
    background-color: var(--nav-active-bg);
}
.nav-item-active {
    background-color: var(--nav-active-bg);
    color: var(--nav-active-text);
    font-weight: 600;
}
.bg-accent-blue {
    background-color: var(--accent-blue);
}
.hover\:bg-accent-blue-hover:hover {
    background-color: var(--accent-blue-hover);
}
.text-accent-blue {
    color: var(--accent-blue);
}
.bg-border-color {
    background-color: var(--border-color);
}

/* Input specific styles for theme */
input[type="text"],
input[type="number"],
input[type="date"],
input[type="time"], /* Added for calendar */
textarea,
select {
    background-color: var(--input-bg);
    color: var(--input-text);
    border-color: var(--border-color);
    padding: 0.75rem;
    border-radius: 0.5rem;
    border-width: 1px; /* Ensure border is visible */
    width: 100%; /* Make sure inputs take full width */
    box-sizing: border-box; /* Include padding and border in the element's total width and height */
}
input[type="checkbox"] {
    /* Basic styling for checkbox */
    accent-color: var(--accent-blue); /* Changes the color of the checked box */
}


/* Recall button specific styles for theme */
.recall-btn.bg-red-100 {
    background-color: rgba(var(--text-red-rgb), 0.1);
    color: var(--text-red);
}
.recall-btn.bg-orange-100 {
    background-color: rgba(var(--text-orange-rgb), 0.1);
    color: var(--text-orange);
}
.recall-btn.bg-yellow-100 {
    background-color: rgba(var(--text-yellow-rgb), 0.1);
    color: var(--text-yellow);
}
.recall-btn.bg-green-100 {
    background-color: rgba(var(--text-green-rgb), 0.1);
    color: var(--text-green);
}

/* List item styles using new variables */
.list-item-themed {
    background-color: var(--list-item-bg);
    border-color: var(--list-item-border);
}
.list-item-themed:hover {
    background-color: var(--list-item-hover-bg);
}

/* Other utility classes */
.chart-container {
    position: relative;
    width: 100%;
    height: 300px; /* Default height */
    max-width: 700px;
    margin-left: auto;
    margin-right: auto;
    max-height: 40vh; /* Responsive height for charts */
}
@media (min-width: 768px) {
    .chart-container {
        height: 350px;
    }
}

/* Flashcard flip effect */
.flip-card {
    transform-style: preserve-3d;
    transition: transform 0.6s;
}
.flip-card.flipped {
    transform: rotateY(180deg);
}
.flip-card-front,
.flip-card-back {
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden; /* For Safari */
    background-color: var(--card-front-bg); /* Use theme variable */
}
.flip-card-back {
    transform: rotateY(180deg);
    background-color: var(--card-back-bg); /* Use theme variable */
}

/* Custom Scrollbar Styling */
::-webkit-scrollbar {
    width: 8px;
}
::-webkit-scrollbar-track {
    background: var(--bg-primary);
}
::-webkit-scrollbar-thumb {
    background: var(--border-color);
    border-radius: 10px;
}
::-webkit-scrollbar-thumb:hover {
    background: var(--text-secondary);
}

/* Modal Overlay Styling */
.modal {
    background-color: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: center;
}

/* Notification Toast Styling */
#notification-toast {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: #4CAF50; /* Green for success */
    color: white;
    padding: 12px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
    min-width: 250px;
    text-align: center;
}
#notification-toast.show {
    opacity: 1;
    visibility: visible;
}
#notification-toast.error {
    background-color: #f44336; /* Red for error */
}

/* Mobile Sidebar Specific Transitions */
#mobile-sidebar-container {
    transition: background-color 0.3s ease-in-out;
}
#mobile-sidebar {
    transition: transform 0.3s ease-in-out;
}

/* Specific styling for quiz options */
.quiz-option-btn {
    padding: 0.75rem 1rem;
    border-radius: 0.5rem;
    font-weight: 500;
    text-align: left;
    transition: background-color 0.2s, border-color 0.2s;
    border: 1px solid var(--border-color);
    background-color: var(--list-item-bg); /* Use list item background */
    color: var(--text-primary); /* Use primary text color */
}

.quiz-option-btn:hover {
    background-color: var(--list-item-hover-bg); /* Use list item hover background */
}

.quiz-option-btn.selected {
    border-color: var(--accent-blue);
    /* This requires custom CSS property to convert RGB to RGBA for boxShadow */
    /* You would define --accent-blue-rgb in your JS for this if needed, or use a hardcoded color */
    box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.5); /* Fallback */
}

.quiz-option-btn.correct {
    background-color: rgba(var(--text-green-rgb), 0.2); /* Light green for correct */
    border-color: var(--text-green);
}

.quiz-option-btn.incorrect {
    background-color: rgba(var(--text-red-rgb), 0.2); /* Light red for incorrect */
    border-color: var(--text-red);
}

/* Ensure focus outline for accessibility */
*:focus {
    outline: 2px solid var(--accent-blue);
    outline-offset: 2px;
}

/* Mind Map Canvas Styling */
#mind-map-canvas {
    background-color: var(--canvas-bg);
    touch-action: none; /* Disable default touch actions for custom drag/pan */
}

/* Specific AI Content Formatting */
.formatted-ai-content h3 {
    font-size: 1.25rem; /* text-xl */
    font-weight: 600; /* font-semibold */
    color: var(--text-primary);
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 0.25rem;
}

.formatted-ai-content ul {
    list-style: disc; /* Default bullet style */
    margin-left: 1.5rem; /* Indent bullets */
    margin-bottom: 1rem;
    color: var(--text-secondary);
}

.formatted-ai-content li {
    margin-bottom: 0.5rem;
}

.formatted-ai-content p {
    margin-bottom: 1rem;
    color: var(--text-secondary);
}

/* Styles for Achievement Cards */
.achievement-card {
    padding: 1.5rem;
    border-radius: 0.75rem;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    background-color: var(--achievement-locked-bg);
    border: 1px solid var(--achievement-border);
    transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
}

.achievement-card.unlocked {
    background-color: var(--achievement-unlocked-bg);
    color: var(--achievement-unlocked-text);
    border-color: rgba(var(--text-green-rgb), 0.5); /* A slightly darker shade for unlocked border */
    transform: translateY(-5px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.achievement-card .icon {
    font-size: 3rem;
    margin-bottom: 0.75rem;
    line-height: 1; /* ensure icon is centered vertically */
}

.achievement-card.unlocked .icon {
    color: var(--achievement-unlocked-text);
}

.achievement-card.locked .icon {
    color: var(--achievement-locked-text);
    opacity: 0.6;
}

.achievement-card h4 {
    font-size: 1.125rem; /* text-lg */
    font-weight: 600; /* font-semibold */
    color: var(--text-primary); /* Default to primary text */
    margin-bottom: 0.5rem;
}

.achievement-card.unlocked h4 {
    color: var(--achievement-unlocked-text); /* Use specific color for unlocked text */
}

.achievement-card.locked h4 {
    color: var(--achievement-locked-text); /* Use specific color for locked text */
}

.achievement-card p {
    font-size: 0.875rem; /* text-sm */
    color: var(--text-secondary); /* Default to secondary text */
}

.achievement-card.unlocked p {
    color: var(--achievement-unlocked-text); /* Use specific color for unlocked text */
}
.achievement-card.locked p {
    color: var(--achievement-locked-text); /* Use specific color for locked text */
}


/* Glossary list item styling */
.glossary-item {
    background-color: var(--list-item-bg);
    border: 1px solid var(--list-item-border);
    border-radius: 0.5rem;
    padding: 1rem;
}

.glossary-item h4 {
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.25rem;
}

.glossary-item p {
    color: var(--text-secondary);
}

/* Calendar Specific Styles */
.calendar-grid-container {
    border-top: 1px solid var(--calendar-day-border);
    border-left: 1px solid var(--calendar-day-border);
}

.calendar-day-cell {
    position: relative;
    padding: 10px;
    min-height: 100px; /* Adjust as needed */
    background-color: var(--calendar-day-bg);
    border-right: 1px solid var(--calendar-day-border);
    border-bottom: 1px solid var(--calendar-day-border);
    cursor: pointer;
    transition: background-color 0.2s;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    overflow: hidden;
}

.calendar-day-cell:hover {
    background-color: var(--calendar-day-hover-bg);
}

.calendar-day-number {
    font-weight: 600;
    font-size: 1.125rem; /* text-lg */
    color: var(--calendar-day-text);
    margin-bottom: 5px;
}

.calendar-day-cell.inactive .calendar-day-number {
    color: var(--calendar-day-inactive-text);
}

.calendar-day-cell.today {
    border: 2px solid var(--calendar-today-border);
    box-shadow: 0 0 0 1px var(--calendar-today-border);
}

.calendar-day-cell.selected-day {
    background-color: var(--calendar-selected-day-bg);
}

.calendar-event-marker {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background-color: var(--calendar-event-dot);
    margin-right: 4px;
    flex-shrink: 0; /* Prevent dot from shrinking */
}

/* Specific colors for event types */
.event-type-assignment .calendar-event-marker { background-color: var(--event-assignment-color); }
.event-type-exam .calendar-event-marker { background-color: var(--event-exam-color); }
.event-type-study .calendar-event-marker { background-color: var(--event-study-color); }
.event-type-other .calendar-event-marker { background-color: var(--event-other-color); }


.calendar-event-title {
    font-size: 0.75rem; /* text-xs */
    color: var(--text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 1;
}

.calendar-event-item {
    display: flex;
    align-items: center;
    width: 100%;
    margin-top: 2px;
}
